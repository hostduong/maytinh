{{ define "ho_so" }}
    {{ template "header" . }}

    <div class="max-w-2xl mx-auto relative">
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100">
             <div class="bg-gradient-to-r from-blue-600 to-blue-400 p-6 text-white text-center">
                <div class="text-6xl mb-2">üë§</div>
                <h1 class="text-2xl font-bold" id="lblHoTen">{{ .NhanVien.HoTen }}</h1>
                <p class="opacity-90">{{ .NhanVien.ChucVu }}</p>
            </div>
            <div class="bg-gray-50 p-6 flex justify-center gap-4">
                <button onclick="toggleModal('modalPass')" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition shadow">
                    ƒê·ªïi m·∫≠t kh·∫©u
                </button>
                <button onclick="toggleModal('modalInfo')" class="bg-white border border-gray-300 hover:bg-gray-100 text-gray-700 px-6 py-2 rounded-lg font-medium transition">
                    C·∫≠p nh·∫≠t th√¥ng tin
                </button>
                <button onclick="toggleModal('modalPin')" class="bg-purple-100 text-purple-700 hover:bg-purple-200 px-6 py-2 rounded-lg font-medium transition">
                    ƒê·ªïi m√£ PIN
                </button>
            </div>
        </div>

        <div id="modalPass" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white p-6 rounded-xl shadow-2xl w-96">
                <h3 class="text-lg font-bold mb-4">üîê ƒê·ªïi M·∫≠t Kh·∫©u</h3>
                <input type="password" id="oldPass" placeholder="M·∫≠t kh·∫©u c≈©" class="w-full p-2 border rounded mb-3">
                <input type="password" id="newPass" placeholder="M·∫≠t kh·∫©u m·ªõi" class="w-full p-2 border rounded mb-4">
                <div class="flex justify-end gap-2">
                    <button onclick="toggleModal('modalPass')" class="text-gray-500 hover:bg-gray-100 px-4 py-2 rounded">H·ªßy</button>
                    <button onclick="doiPass()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">L∆∞u</button>
                </div>
            </div>
        </div>

        <div id="modalInfo" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white p-6 rounded-xl shadow-2xl w-96">
                <h3 class="text-lg font-bold mb-4">‚úèÔ∏è C·∫≠p nh·∫≠t th√¥ng tin</h3>
                <input type="text" id="newName" value="{{ .NhanVien.HoTen }}" placeholder="H·ªç v√† t√™n" class="w-full p-2 border rounded mb-4">
                <div class="flex justify-end gap-2">
                    <button onclick="toggleModal('modalInfo')" class="text-gray-500 hover:bg-gray-100 px-4 py-2 rounded">H·ªßy</button>
                    <button onclick="doiTen()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">L∆∞u</button>
                </div>
            </div>
        </div>

        <div id="modalPin" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white p-6 rounded-xl shadow-2xl w-96">
                <h3 class="text-lg font-bold mb-4">üî¢ ƒê·ªïi M√£ PIN</h3>
                <input type="text" id="oldPin" maxlength="6" placeholder="M√£ PIN c≈©" class="w-full p-2 border rounded mb-3">
                <input type="text" id="newPin" maxlength="6" placeholder="M√£ PIN m·ªõi (6 s·ªë)" class="w-full p-2 border rounded mb-4">
                <div class="flex justify-end gap-2">
                    <button onclick="toggleModal('modalPin')" class="text-gray-500 hover:bg-gray-100 px-4 py-2 rounded">H·ªßy</button>
                    <button onclick="doiPin()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">L∆∞u</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        function toggleModal(id) {
            document.getElementById(id).classList.toggle('hidden');
        }

        async function postData(url, data) {
            const formData = new FormData();
            for(const k in data) formData.append(k, data[k]);
            const res = await fetch(url, { method: 'POST', body: formData });
            return await res.json();
        }

        async function doiPass() {
            const res = await postData('/api/user/change-pass', {
                pass_cu: document.getElementById('oldPass').value,
                pass_moi: document.getElementById('newPass').value
            });
            alert(res.msg);
            if(res.status === 'ok') toggleModal('modalPass');
        }

        async function doiTen() {
            const newName = document.getElementById('newName').value;
            const res = await postData('/api/user/update-info', { ho_ten_moi: newName });
            alert(res.msg);
            if(res.status === 'ok') {
                document.getElementById('lblHoTen').innerText = newName;
                toggleModal('modalInfo');
            }
        }

        async function doiPin() {
            const res = await postData('/api/user/change-pin', {
                pin_cu: document.getElementById('oldPin').value,
                pin_moi: document.getElementById('newPin').value
            });
            alert(res.msg);
            if(res.status === 'ok') toggleModal('modalPin');
        }
    </script>

    {{ template "footer" . }}
{{ end }}
